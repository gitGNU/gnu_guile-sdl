2003-11-08  Thien-Thi Nguyen  <ttn@surf.glug.org>

	* sdl.c: Update copyright.
	No longer include <libguile.h>.
	Include <guile/gh.h>.
	No longer include "sdl.h".
	Include "config.h" and "argcheck.h".
	No longer include "sdlrect.h", "sdlcolor.h", "sdlsurface.h",
	"sdlvideo.h", "sdlevent.h", "sdlcdrom.h", "sdljoystick.h"
	and "sdlroto.h".
	Throughout, replace `SCM_DEFINE' with `MDEFLOCEXP'.
	Throughout, use gh_* funcs and other abstractions where possible.
	Convert docstrings: "returns" -> "return", etc.
	(gsdl_init_enums): Add forward decl for this func.
	(gsdl_init_rect, gsdl_init_color, gsdl_init_video,
	gsdl_init_surface, gsdl_init_rotozoom, gsdl_init_event,
	gsdl_init_joystick, gsdl_init_cdrom): Likewise.
	(gsdl_smob_tags): New var.
	(sdl_init_flags): Make static.
	(sdl_get_init_flags): New MDEFLOCEXP func.
	(gsdl_init_flagstash): New extern var decl.
	(init_module): Rename from `guile_sdl_init' and make static.
	Use `gsdl_make_flagstash' and associated arglist to
	set `sdl_init_flags' instead of `scm_c_define_flag'.
	Remove call to `scm_c_export'.
	(scm_init_sdl_sdl_sup_module): New func, declared and
	defined using macro `MDEFLINKFUNC'.

	* sdlcdrom.c: Update copyright.
	No longer include <libguile.h>.
	Include <guile/gh.h>.
	No longer include "sdlcdrom.h".
	Include "config.h", "argcheck.h" and "sdlsmobs.h".
	Throughout, replace `SCM_DEFINE' with `MDEFLOCEXP'.
	Throughout, use gh_* funcs and other abstractions where possible.
	Convert docstrings: "returns" -> "return", etc.
	(cdrom_tag): Rename from `sdl_cdrom_tag'. Make static.
	(ASSERT_CDROM): New macro.
	(sdl_cd_get_nth_track): Make return value assoc list w/
	one SCM_LISTn call instead of with multiple `scm_acons' calls.
	(sdl_cd_frames_to_msf): Likewise.
	(gsdl_sym_offset, gsdl_sym_length, gsdl_sym_type, gsdl_sym_id,
	gsdl_sym_f, gsdl_sym_s, gsdl_sym_m): New static vars.
	(mark_cd): New static func.
	(free_cd, print_cd): Make static.
	(sdl_init_cdrom): Register `mark_cd'.
	Remove call to `scm_c_export'.

	* sdlcolor.c: Update copyright.
	No longer include <libguile.h>.
	Include <guile/gh.h>.
	No longer include "sdlsurface.h".
	Include "config.h", "argcheck.h" and "wholefns.h".
	Throughout, replace `SCM_DEFINE' with `MDEFLOCEXP'.
	Throughout, use gh_* funcs and other abstractions where possible.
	Convert docstrings: "returns" -> "return", etc.
	(color_tag): Make static.
	(mark_color): New static func.
	(free_color, print_color): Make static.
	(NUMBER_GETTER, NUMBER_SETTER, NUMBER_GETSET): New macros.
	(sdl_init_color): Register `mark_color'.
	Remove calls to `scm_c_define_gsubr'.
	Remove call to `scm_c_export'.

	* sdlenums.c: Update copyright.
	No longer include <libguile.h>.
	Include <guile/gh.h>.
	No longer include "sdlsurface.h".
	Include "config.h" and "argcheck.h".
	Throughout, replace `SCM_DEFINE' with `MDEFLOCEXP'.
	Throughout, use gh_* funcs and other abstractions where possible.
	Convert docstrings: "returns" -> "return", etc.
	(MAX_FLAGS): Delete macro.
	(enum_tag): Make static.
	(enum_struct): New struct.
	(mark_enum, free_enum): Make static.
	(REASONABLE_BUCKET_COUNT): New macro.
	(MAKE_HASH_TABLE): New macro.
	(gsdl_define_enum): Rename from `scm_c_define_enum'.
	(gsdl_enum2long): Rename from `scm_enum2long'.
	(gsdl_long2enum): Rename from `scm_long2enum'.
	(number_to_enum): Rename from `scm_number_to_enum'. Make MDEFLOCEXP.
	(scm_c_define_flag): Delete func.
	(flagstash_tag): New static var.
	(ASSERT_FLAGSTASH): New macro.
	(mark_flagstash, free_flagstash, print_flagstash): New static funcs.
	(gsdl_make_flagstash): New func.
	(gsdl_flags2ulong): Rename from `scm_flags2ulong'.
	Remove support for `flags' being an exact number.
	Add support for `flags' being a single symbol.
	(gsdl_ulong2flags): Rename from `scm_ulong2flags'.
	Fix bug: Test full mask instead of only one bit position.
	Fix bug: Handle case where stash has a member w/ value 0x0.
	No longer unconditionally return computed result; instead,
	return SCM_BOOL_F if the stash does not cover the value.
	(flagstash_flags): New MDEFLOCEXP func.
	(flags_to_number): Rename from `scm_flags_to_number'.
	Make MDEFLOCEXP.
	(number_to_flags): Likewise from `scm_number_to_flags'.
	(gsdl_init_enums): Renaem from `sdl_init_enums'.
	Register smob type "flagstash" and its mark, free, print funcs.
	Remove call to `scm_c_export'.

	* sdlevent.c: Update copyright.
	Include <guile/gh.h>.
	No longer include "sdlevent.h".
	Include "config.h", "argcheck.h" and "wholefns.h".
	Throughout, replace `SCM_DEFINE' with `MDEFLOCEXP'.
	Throughout, use gh_* funcs and other abstractions where possible.
	Convert docstrings: "returns" -> "return", etc.
	(event_tag, keysym_tag, event_mod_flags): Make static.
	(ASSERT_EVENT, ASSERT_KEYSYM): New macros.
	(mark_event, mark_keysym, free_keysym): New static funcs.
	(free_event): Make static.
	(make_keysym): Make MDEFLOCEXP.
	(ENUM_GETTER, ENUM_SETTER, ENUM_GETSET, NUMBER_GETTER,
	NUMBER_SETTER, NUM2_GETTER, NUM2_SETTER, NUM2_GETSET,
	NUM3_GETTER, NUM3_SETTER, NUM3_GETSET, FLAG_GETTER,
	FLAG_SETTER, FLAG_GETSET): New macros.
	(pump_events, peep_events, poll_event, wait_event, push_event,
	set_event_filter, get_event_filter, event_state, sdl_enable_unicode,
	sdl_enable_key_repeat, sdl_get_key_state, sdl_get_mod_state,
	sdl_set_mod_state, sdl_get_mouse_state, sdl_get_relative_mouse_state,
	sdl_button_p): Make MDEFLOCEXP.
	(gsdl_sym_state, gsdl_sym_x, gsdl_sym_y): New static vars.
	(sdl_get_event_mod_flags): New MDEFLOCEXP.
	(gsdl_kmod_flagstash): New extern var decl.
	(gsdl_init_event): Rename from `sdl_init_event'.
	Register `mark_event'.
	Register smob type "SDL-Keysym" and its mark and free funcs.
	Initialize `event_mod_flags' using `gsdl_make_flagstash'
	instead of `scm_c_define_flag'.
	Remove calls to `scm_c_define_gsubr'.
	Remove call to `scm_c_export'.

	* sdlgfx.c: Update copyright.
	Include <guile/gh.h> and <SDL/SDL_image.h>.
	No longer include "sdlgfx.h".
	Include "config.h", "argcheck.h" and "sdlsmobs.h".
	Throughout, replace `SCM_DEFINE' with `MDEFLOCEXP'.
	Throughout, use gh_* funcs and other abstractions where possible.
	Write docstrings.
	(gsdl_gfx_init): Rename from `sdl_gfx_init'.
	Remove calls to `scm_c_define_gsubr'.
	Remove call to `scm_c_export'.

	* sdljoystick.c: Update copyright.
	No longer include <libguile.h>.
	No longer include "sdljoystick.h".
	Include "config.h", "argcheck.h" and "sdlsmobs.h".
	Throughout, replace `SCM_DEFINE' with `MDEFLOCEXP'.
	Throughout, use gh_* funcs and other abstractions where possible.
	Convert docstrings: "returns" -> "return", etc.
	(joystick_tag): Rename from `sdl_joystick_tag'. Make static.
	(ASSERT_JOYSTICK): New macro.
	(gsdl_init_joystick): Rename from `sdl_init_joystick'.
	Register func `mark_joy'.
	Remove call to `scm_c_export'.

	* sdlrect.c: Update copyright.
	No longer include <libguile.h>.
	Include <guile/gh.h>.
	No longer include "sdlenums.h".
	No longer include "sdlrect.h".
	Include "config.h", "argcheck.h" and "wholefns.h".
	Throughout, replace `SCM_DEFINE' with `MDEFLOCEXP'.
	Throughout, use gh_* funcs and other abstractions where possible.
	Convert docstrings: "returns" -> "return", etc.
	(rect_tag): Delete var.
	(mark_rect): New static func.
	(free_rect, print_rect): Make static.
	(gsdl_init_rect): Rename from `sdl_init_rect'.
	Register func `mark_rect'.
	Remove calls to `scm_c_define_gsubr'.
	Remove call to `scm_c_export'.

	* sdlroto.c: Update copyright.
	No longer include <libguile.h>.
	No longer include "sdlroto.h".
	No longer include "sdlvideo.h".
	Include "config.h", "argcheck.h" and "sdlsmobs.h".
	Throughout, replace `SCM_DEFINE' with `MDEFLOCEXP'.
	Throughout, use gh_* funcs and other abstractions where possible.
	Convert docstrings: "returns" -> "return", etc.
	(gsdl_init_rotozoom): Rename from `sdl_init_rotozoom'.
	Remove call to `scm_c_export'.

	* sdlsurface.c: Update copyright.
	No longer include <libguile.h>.
	Include <guile/gh.h>.
	No longer include "sdlsurface.h".
	Include "config.h", "argcheck.h" and "wholefns.h".
	Throughout, replace `SCM_DEFINE' with `MDEFLOCEXP'.
	Throughout, use gh_* funcs and other abstractions where possible.
	Convert docstrings: "returns" -> "return", etc.
	(surface_tag): Delete var.
	(mark_surface): New static func.
	(free_surface, print_surface): Make static.
	(gsdl_init_surface): Rename from `sdl_init_surface'.
	Register func `mark_surface'.
	Remove calls to `scm_c_define_gsubr'.
	Remove call to `scm_c_export'.

2003-11-07  Thien-Thi Nguyen  <ttn@surf.glug.org>

	* Makefile.am (AM_CPPFLAGS): Add "-Ifoo"
	for $(srcdir) and some children.
	(lib_LTLIBRARIES): Delete directive.
	(libguileSDL_la_SOURCES): Likewise.
	(libguileSDL_la_CFLAGS): Likewise.
	(libguileSDL_la_LIBADD): Likewise.
	(libguileSDL_la_LDFLAGS): Likewise.
	(libguileSDL_la_DEPENDENCIES): Likewise.
	(cmoddir): New var.
	(cmod_LTLIBRARIES): New directive.
	(FLAGSTASH): New var.
	(BUILT_SOURCES): Add $(FLAGSTASH).
	(sdl_sup_la_SOURCES): New directive.
	(sdl_sup_la_LDFLAGS): Likewise.
	(SUFFIXES): Add ".fspec".
	(GUILE_SNARF): Delete var.
	(.c.x): Use pre-inst-$(c2x) instead of $(GUILE_SNARF).
	(.fspec.c): New pattern rule.

2003-11-07  Thien-Thi Nguyen  <ttn@surf.glug.org>

	* initf.fspec (#:gperf-options): Add "--includes".
	* kmodf.fspec: Likewise.
	* overlayf.fspec: Likewise.
	* palettef.fspec: Likewise.
	* videof.fspec: Likewise.

2003-11-06  Thien-Thi Nguyen  <ttn@surf.glug.org>

	* initf.fspec: New file.
	* kmodf.fspec: Likewise.
	* overlayf.fspec: Likewise.
	* palettef.fspec: Likewise.
	* videof.fspec: Likewise.

2003-10-29  Thien-Thi Nguyen  <ttn@surf.glug.org>

	* Makefile.am (CC, CFLAGS, LIBS): Delete vars.
	(AM_CPPFLAGS): Renamed from `INCLUDES'.

2003-10-29  Thien-Thi Nguyen  <ttn@surf.glug.org>

	* Makefile.am (PACKAGE, VERSION): Delete directives.

2003-10-29  Thien-Thi Nguyen  <ttn@surf.glug.org>

	* Makefile.am: Merge multiple `SUFFIXES' directives into one.

